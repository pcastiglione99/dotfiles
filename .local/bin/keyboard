#!/usr/bin/env bash

# Get the current input device ID
INPUT_ID=$(swaymsg -t get_inputs | jq -r '.[] | select(.type == "keyboard") | .identifier' | head -n 1)

# Get current layout (e.g., "us" or "it")
CURRENT_LAYOUT=$(swaymsg -t get_inputs | jq -r --arg id "$INPUT_ID" '.[] | select(.identifier == $id) | .xkb_active_layout_name')

# Toggle layout
if [[ "$CURRENT_LAYOUT" =~ "English" ]]; then
    NEW_LAYOUT="it"
    NEW_LAYOUT_NAME="Italiano ðŸ‡®ðŸ‡¹"
else
    NEW_LAYOUT="us"
    NEW_LAYOUT_NAME="English ðŸ‡ºðŸ‡¸"
fi

# Apply the new layout
swaymsg input type:keyboard xkb_layout $NEW_LAYOUT > /dev/null

# Show notification
dunstify -a "Keyboard Layout" "$NEW_LAYOUT_NAME"
